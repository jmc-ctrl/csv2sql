INSERT INTO test_file.csv ['### Reads .csv file and converts to single SQL insert statement.\n'] VALUES (['### Reads .csv file and converts to single SQL insert statement.\n', '\n', 'import sys # For arguments\n', '\n', 'def open_file(file_name):\n', '    """Opens file, stores whole file in variable.\n', '    Either returns the data from the file, or None if invalid filename."""\n', '    file_data = []\n', '    with open(file_name,"r") as file:\n', '        for rows in file:\n', '            file_data.append(rows) # Iterating through each row and appending it to the list.\n', '        return file_data # Returns data and closes file due to with.\n', '    return None # None is returned for an invalid file type.\n', '\n', 'def preprocess_data(data):\n', '    """Splits data into 2D array, index 0 is headers, index 1 is the data for inserts."""\n', '    headers = data[0]\n', '    actual_data = data[0:] # All things in list > index 0.\n', '\n', '    return [[headers],[actual_data]]\n', '\n', 'def write_sql_file(output_filename,data):\n', '    with open(output_filename,"w") as output:\n', '        output.writelines(data) # Dumps all data to the file.\n', '\n', 'class InsertStatement:\n', '    def __init__(self, table_name, entities, data):\n', '        self.table_name = table_name\n', '        self.entities = entities\n', '        self.data = data\n', '        self.modified_data = [] # Has to be here to work.\n', '        self.format_values()\n', '    \n', '    def format_values(self):\n', '        modified_data = []\n', '        for i, items in enumerate(self.data): # Switched to enumerated list.\n', "            if i == len(self.data) - 1:  # Last item can't have ,\n", '                modified_data.append(f"({items})")\n', '            else:\n', '                modified_data.append(f"({items}),") \n', '        \n', '        self.modified_data = modified_data  # Stored as instance variable part of class.\n', '    \n', '    def create_statement(self):\n', '        # Join all formatted data elements\n', '        values = \'\'.join(self.modified_data) # Variable to store inserts. Also changed to \'\' as per SQL syntax instead of "".\n', '        statement = f"INSERT INTO {self.table_name} {self.entities} VALUES {values};"\n', '        return statement\n', '\n', '\n', 'if __name__ == "__main__":\n', '    try:\n', '        raw_data = preprocess_data(open_file(str(sys.argv[0])))\n', '        statement_data = InsertStatement(str(sys.argv[1]),raw_data[0],raw_data[1])\n', '        write_sql_file(str(sys.argv[2]),statement_data.create_statement())\n', '    except Exception as e:\n', '        print(f"An error occured: {e}.")\n', '        print("Arguments: python csv2sql.py SOURCE_FILENAME TABLE_NAME OUTPUT_FILENAME")']);